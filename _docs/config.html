<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="API: The inputs are specified through 4 excel sheets for frieght corridor analysis. The python code reads these inputs parameters from the following excel sheets for analysis.">

<title>evci_tool - EVCI config</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="evci_tool - EVCI config">
<meta property="og:description" content="API: The inputs are specified through 4 excel sheets for frieght corridor analysis. The python code reads these inputs parameters from the following excel sheets for analysis.">
<meta property="og:site-name" content="evci_tool">
<meta name="twitter:title" content="evci_tool - EVCI config">
<meta name="twitter:description" content="API: The inputs are specified through 4 excel sheets for frieght corridor analysis. The python code reads these inputs parameters from the following excel sheets for analysis.">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">evci_tool</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/AnoopRKulkarni/evci_tool/"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">EVCI config</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">EVCI Siting Tool</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./config.html" class="sidebar-item-text sidebar-link active">EVCI config</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model.html" class="sidebar-item-text sidebar-link">EVCI siting model</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./maps.html" class="sidebar-item-text sidebar-link">EVCI maps</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./analysis.html" class="sidebar-item-text sidebar-link">EVCI analysis</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#read-input-data" id="toc-read-input-data" class="nav-link active" data-scroll-target="#read-input-data">Read input data</a>
  <ul>
  <li><a href="#setup_and_read_data" id="toc-setup_and_read_data" class="nav-link" data-scroll-target="#setup_and_read_data">setup_and_read_data</a></li>
  </ul></li>
  <li><a href="#data-availability-check" id="toc-data-availability-check" class="nav-link" data-scroll-target="#data-availability-check">Data availability check</a>
  <ul>
  <li><a href="#data_availability_check" id="toc-data_availability_check" class="nav-link" data-scroll-target="#data_availability_check">data_availability_check</a></li>
  </ul></li>
  <li><a href="#data-integrity-check" id="toc-data-integrity-check" class="nav-link" data-scroll-target="#data-integrity-check">Data integrity check</a>
  <ul>
  <li><a href="#data_integrity_check" id="toc-data_integrity_check" class="nav-link" data-scroll-target="#data_integrity_check">data_integrity_check</a></li>
  </ul></li>
  <li><a href="#read-global-variables-from-xlsx" id="toc-read-global-variables-from-xlsx" class="nav-link" data-scroll-target="#read-global-variables-from-xlsx">Read global variables from xlsx</a>
  <ul>
  <li><a href="#read_globals" id="toc-read_globals" class="nav-link" data-scroll-target="#read_globals">read_globals</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/AnoopRKulkarni/evci_tool/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">EVCI config</h1>
</div>

<div>
  <div class="description">
    <strong>API</strong>: The inputs are specified through 4 excel sheets for frieght corridor analysis. The python code reads these inputs parameters from the following excel sheets for analysis.
  </div>
</div>


<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<ol type="1">
<li>model.xlsx - This contains all the global parameters that are model specific. They remain valid for every corridor that needs analysis.</li>
<li>sites.xlsx - This contains a list of sites, with their latitude and longitude for analysis. This is an initial list of sites. This file needs to be created for each freight corridor</li>
<li>traffic.xlsx - This contains a typical traffic profile around the sites for each freight corridor.</li>
<li>grid.xlsx - This contains information about neighboring distribution transformers from where the chargers deployed at each site will draw power from.</li>
</ol>
<section id="read-input-data" class="level1">
<h1>Read input data</h1>
<hr>
<section id="setup_and_read_data" class="level3">
<h3 class="anchored" data-anchor-id="setup_and_read_data">setup_and_read_data</h3>
<blockquote class="blockquote">
<pre><code> setup_and_read_data (corridor:str, input_path='input/',
                      output_path='output/')</code></pre>
</blockquote>
<p>This function sets up paths and reads input excel files for a specified corridor</p>
<p><code>Arguments</code>:</p>
<ol type="1">
<li><code>corridor</code>: a string that identifies the corridor being analyzed (e.g.&nbsp;chandigarh_leh)</li>
<li><code>input_path</code>: a string denoting base directory under which input files (xlsx and shape files) are available for analysis. Default is <code>'input/'</code></li>
<li><code>output_path</code>: a string denoting base directory under which output files will be stored. Default is <code>'output/'</code></li>
</ol>
<p><code>Returns</code>:</p>
<ol type="1">
<li><code>model</code>: dataframe of model parameters (from model.xlsx)</li>
<li><code>sites</code>: dataframe of sites (from sites.xlsx)</li>
<li><code>traffic</code>: dataframe of traffic profile (from traffic.xlsx)</li>
<li><code>grid</code>: dataframe of grid parameters (from grid.xlsx)</li>
<li><code>INPUT_PATH</code>: a string indicating the input_path (e.g.&nbsp;input/chandigarh_leh/)</li>
<li><code>OUTPUT_PATH</code>: a string indicating the output path (e.g.&nbsp;output/chandigarh_leh/)</li>
</ol>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#example usage</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>m,s,t,g,INPUT_PATH,OUTPUT_PATH <span class="op">=</span> setup_and_read_data(<span class="st">'chandigarh_leh'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="data-availability-check" class="level1">
<h1>Data availability check</h1>
<p>Let’s check if the four excel sheets provided have the correctly named worksheets within them.</p>
<hr>
<section id="data_availability_check" class="level3">
<h3 class="anchored" data-anchor-id="data_availability_check">data_availability_check</h3>
<blockquote class="blockquote">
<pre><code> data_availability_check (m, s, t, g)</code></pre>
</blockquote>
<p>This function checks if the excel files contain the mandatory worksheets.</p>
<p><code>Arguments</code>:</p>
<ol type="1">
<li><code>m</code>: dataframe of model parameters (from model.xlsx)</li>
<li><code>s</code>: dataframe of sites (from sites.xlsx)</li>
<li><code>t</code>: dataframe of traffic profile (from traffic.xlsx)</li>
<li><code>g</code>: dataframe of grid parameters (from grid.xlsx)</li>
</ol>
<p><code>Returns</code>:</p>
<p>A list of xlsx file names wiht missing mandatory sheets</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>data_availability_check(m,s,t,g)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>[]</code></pre>
</div>
</div>
</section>
</section>
<section id="data-integrity-check" class="level1">
<h1>Data integrity check</h1>
<p>Let’s now check if any of the mandatory columns in each of the worksheets are all empty!</p>
<hr>
<section id="data_integrity_check" class="level3">
<h3 class="anchored" data-anchor-id="data_integrity_check">data_integrity_check</h3>
<blockquote class="blockquote">
<pre><code> data_integrity_check (m, s, t, g, verbose=False)</code></pre>
</blockquote>
<p>This function checks for integrity of excel data by checking missing values.</p>
<p><code>Arguments</code>:</p>
<ol type="1">
<li><code>m</code>: dataframe of model parameters (from model.xlsx)</li>
<li><code>s</code>: dataframe of sites (from sites.xlsx)</li>
<li><code>t</code>: dataframe of traffic profile (from traffic.xlsx)</li>
<li><code>g</code>: dataframe of grid parameters (from grid.xlsx)</li>
</ol>
<p><code>Returns</code>:</p>
<p>A dictionary of missing columns with their corresponding xlsx filename and worksheet name.</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>data_integrity_check(m,s,t,g)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>[{'charger_specific': ['Range',
   'UoM',
   '2W',
   '3WS',
   '4WS',
   '4WF',
   'Unnamed: 9',
   '2W.1',
   '3WS.1',
   '4WS.1',
   '4WF.1'],
  'battery_specific': ['Parameter',
   'Value',
   'Range',
   'User Input?',
   'Unnamed: 4',
   'Same battery swapping station is used for 2W and 3W',
   'Unnamed: 6',
   'Unnamed: 7',
   'Unnamed: 8',
   'Unnamed: 9',
   'Unnamed: 10',
   'Unnamed: 11',
   'Unnamed: 12',
   'Unnamed: 13',
   'Unnamed: 14',
   'Unnamed: 15',
   'Unnamed: 16',
   'Unnamed: 17',
   'Unnamed: 18',
   'Unnamed: 19'],
  'others': ['Range']},
 {'sites': ['Address',
   'Traffic congestion',
   'Year for Site recommendation',
   'Hoarding/Kiosk (1 is yes &amp; 0 is no)',
   'Hoarding margin',
   'Kiosk margin',
   'Available area',
   'Upfront cost per sqm (land)',
   'Yearly cost per sqm (land)',
   'Upfront cost per sqm (kiosk)',
   'Yearly cost per sqm (kiosk)',
   'Upfront cost per sqm (hoarding)',
   'Yearly cost per sqm (hoarding)',
   'Battery swap available']},
 {'profile': []},
 {'grid': ['Longitude',
   'Latitude',
   'Tariff',
   'Power Outage',
   'Available load']}]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># verbose output</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>data_integrity_check(m,s,t,g,verbose<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Column 'Range' of 'charger_specific' has 12/15 missing values
Column 'UoM' of 'charger_specific' has 8/15 missing values
Column '2W' of 'charger_specific' has 8/15 missing values
Column '3WS' of 'charger_specific' has 8/15 missing values
Column '4WS' of 'charger_specific' has 8/15 missing values
Column '4WF' of 'charger_specific' has 8/15 missing values
Column 'Unnamed: 9' of 'charger_specific' has 15/15 missing values
Column '2W.1' of 'charger_specific' has 9/15 missing values
Column '3WS.1' of 'charger_specific' has 9/15 missing values
Column '4WS.1' of 'charger_specific' has 9/15 missing values
Column '4WF.1' of 'charger_specific' has 9/15 missing values
Column 'Parameter' of 'battery_specific' has 10/18 missing values
Column 'Value' of 'battery_specific' has 10/18 missing values
Column 'Range' of 'battery_specific' has 18/18 missing values
Column 'User Input?' of 'battery_specific' has 10/18 missing values
Column 'Unnamed: 4' of 'battery_specific' has 18/18 missing values
Column 'Same battery swapping station is used for 2W and 3W' of 'battery_specific' has 11/18 missing values
Column 'Unnamed: 6' of 'battery_specific' has 11/18 missing values
Column 'Unnamed: 7' of 'battery_specific' has 11/18 missing values
Column 'Unnamed: 8' of 'battery_specific' has 16/18 missing values
Column 'Unnamed: 9' of 'battery_specific' has 18/18 missing values
Column 'Unnamed: 10' of 'battery_specific' has 18/18 missing values
Column 'Unnamed: 11' of 'battery_specific' has 18/18 missing values
Column 'Unnamed: 12' of 'battery_specific' has 17/18 missing values
Column 'Unnamed: 13' of 'battery_specific' has 18/18 missing values
Column 'Unnamed: 14' of 'battery_specific' has 18/18 missing values
Column 'Unnamed: 15' of 'battery_specific' has 18/18 missing values
Column 'Unnamed: 16' of 'battery_specific' has 18/18 missing values
Column 'Unnamed: 17' of 'battery_specific' has 18/18 missing values
Column 'Unnamed: 18' of 'battery_specific' has 18/18 missing values
Column 'Unnamed: 19' of 'battery_specific' has 17/18 missing values
Column 'Range' of 'others' has 8/8 missing values
Column 'Address' of 'sites' has 48/48 missing values
Column 'Traffic congestion' of 'sites' has 48/48 missing values
Column 'Year for Site recommendation' of 'sites' has 48/48 missing values
Column 'Hoarding/Kiosk (1 is yes &amp; 0 is no)' of 'sites' has 48/48 missing values
Column 'Hoarding margin' of 'sites' has 48/48 missing values
Column 'Kiosk margin' of 'sites' has 48/48 missing values
Column 'Available area' of 'sites' has 48/48 missing values
Column 'Upfront cost per sqm (land)' of 'sites' has 48/48 missing values
Column 'Yearly cost per sqm (land)' of 'sites' has 48/48 missing values
Column 'Upfront cost per sqm (kiosk)' of 'sites' has 48/48 missing values
Column 'Yearly cost per sqm (kiosk)' of 'sites' has 48/48 missing values
Column 'Upfront cost per sqm (hoarding)' of 'sites' has 48/48 missing values
Column 'Yearly cost per sqm (hoarding)' of 'sites' has 48/48 missing values
Column 'Battery swap available' of 'sites' has 48/48 missing values
Column 'Longitude' of 'grid' has 1/4 missing values
Column 'Latitude' of 'grid' has 1/4 missing values
Column 'Tariff' of 'grid' has 4/4 missing values
Column 'Power Outage' of 'grid' has 4/4 missing values
Column 'Available load' of 'grid' has 4/4 missing values</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>[{'charger_specific': ['Range',
   'UoM',
   '2W',
   '3WS',
   '4WS',
   '4WF',
   'Unnamed: 9',
   '2W.1',
   '3WS.1',
   '4WS.1',
   '4WF.1'],
  'battery_specific': ['Parameter',
   'Value',
   'Range',
   'User Input?',
   'Unnamed: 4',
   'Same battery swapping station is used for 2W and 3W',
   'Unnamed: 6',
   'Unnamed: 7',
   'Unnamed: 8',
   'Unnamed: 9',
   'Unnamed: 10',
   'Unnamed: 11',
   'Unnamed: 12',
   'Unnamed: 13',
   'Unnamed: 14',
   'Unnamed: 15',
   'Unnamed: 16',
   'Unnamed: 17',
   'Unnamed: 18',
   'Unnamed: 19'],
  'others': ['Range']},
 {'sites': ['Address',
   'Traffic congestion',
   'Year for Site recommendation',
   'Hoarding/Kiosk (1 is yes &amp; 0 is no)',
   'Hoarding margin',
   'Kiosk margin',
   'Available area',
   'Upfront cost per sqm (land)',
   'Yearly cost per sqm (land)',
   'Upfront cost per sqm (kiosk)',
   'Yearly cost per sqm (kiosk)',
   'Upfront cost per sqm (hoarding)',
   'Yearly cost per sqm (hoarding)',
   'Battery swap available']},
 {'profile': []},
 {'grid': ['Longitude',
   'Latitude',
   'Tariff',
   'Power Outage',
   'Available load']}]</code></pre>
</div>
</div>
</section>
</section>
<section id="read-global-variables-from-xlsx" class="level1">
<h1>Read global variables from xlsx</h1>
<hr>
<section id="read_globals" class="level3">
<h3 class="anchored" data-anchor-id="read_globals">read_globals</h3>
<blockquote class="blockquote">
<pre><code> read_globals (m, s, t, g, ui_inputs)</code></pre>
</blockquote>
<p>This function returns all global parameters read from the xlsx.</p>
<p><code>Arguments</code>:</p>
<ol type="1">
<li><code>m</code>: dataframe of model parameters (from model.xlsx)</li>
<li><code>s</code>: dataframe of sites (from sites.xlsx)</li>
<li><code>t</code>: dataframe of traffic profile (from traffic.xlsx)</li>
<li><code>g</code>: dataframe of grid parameters (from grid.xlsx)</li>
<li><code>ui_inputs</code>: dictionary of all parameters selected by use from the frontend with the UI</li>
</ol>
<p><code>Returns</code>:</p>
<p>A dictionary with all hyperparameters required for the model to run</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># example usage</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>ui_inputs <span class="op">=</span> { </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"backoff_factor"</span>: <span class="dv">1</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"M"</span>: [<span class="st">"3WS"</span>, <span class="st">"4WS"</span>, <span class="st">"4WF"</span>],</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"years_of_analysis"</span>: [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>],</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"capex_3WS"</span>: <span class="dv">112000</span>,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"capex_4WS"</span>: <span class="dv">250000</span>,</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"capex_4WF"</span>: <span class="dv">1500000</span>,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"hoarding cost"</span>: <span class="dv">900000</span>,</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"kiosk_cost"</span>: <span class="dv">180000</span>,</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"year1_conversion"</span>: <span class="fl">0.02</span>,</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"year2_conversion"</span>: <span class="fl">0.05</span>,</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"year3_conversion"</span>: <span class="fl">0.1</span>,</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"holiday_percentage"</span>: <span class="fl">0.3</span>,</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"fast_charging"</span>: <span class="fl">0.3</span>,</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"slow_charging"</span>: <span class="fl">0.15</span>,</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"cluster"</span>: <span class="va">False</span>,</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"cluster_th"</span>: <span class="fl">0.2</span>,</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"plot_dendrogram"</span>: <span class="va">False</span>,</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">"use_defaults"</span>: <span class="va">False</span> </span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> read_globals(m,s,t,g, ui_inputs)</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(r[<span class="st">'Kj'</span>])</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(r[<span class="st">'charger_types'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{'3WS': 112000, '4WS': 250000, '4WF': 1500000}
['3WS', '4WS', '4WF']</code></pre>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>